---
title: "【ICP #1】ICP復習 "
date: "2023-2-11"
thumbnail: "/images/thumbnail04.jpg"
---
C3Fの方とミーティングする機会があったので、この機に情報精査。

# 1. ICP関連
![imageAlt](https://imgs.coinpost-ext.com/uploads/2021/10/211015_motoko.jpg "motoko")   


## 1-1. 概要
- 2015年にコンセプト考案
- 2016年にDfinity foundationの設立
- 2021年にメインネットローンチ  
従来のインターネットを拡張し、アプリケーションを実行するためのリソースをコンピュータのグローバルネットワークで提供するもの。  
AWS、Microsoft Azureといった中央集権的なサーバー体制を完全にオンチェーン化を目指し、分散化されたアプリケーションの構築を実現する。  



## 1-1.キャニスター
ICにホストされるスマートコントラクト。
コンパイルされた実行プログラム、データを保存するためのメモリも持つ。  

## 1-2. サイクル
サイクルとは、イーサリアムにおけるガスのようなものでキャニスターが稼働するためのコストとして使われる。根本的な違いは、イーサリアムが「ユーザーペイ」、ICは「スマートコントラクトペイ」（リバースガス）モデルを活用している点。キャニスターにあらかじめ開発者がサイクルをチャージするため、エンドユーザーは自分が開始した計算の対価としてトークンを支払うことなく、サービスを利用可能。  
ただし、送金手数料自体にはガス代がかかる。SonicといったDEXでSwapする際にガス代の要求が出てくる。

### なぜサイクルに変換する必要が？
ICPトークンは市場価格により変動しますが、サイクルの価格はキャニスターの運用コストが予測可能であることを保証するために固定。開発者がIC上で開発を行いやすくするためにサイクルを用いる。

## 1-3. Dfinityとは
- Dominic Williams氏が創設したDfinity財団という非営利団体。
- ブロックチェーンを活用して分散型のネットワークを構築し、IT大手のような特定企業に依存している現状から脱却することを目指す。
- カストディアルのデメリットとして、AWS等に障害が発生した場合、銀行等のアプリが使えなくなり広範囲に影響を及ぼす。
- そのため、分散型ネットワークを構築する。
- まとめると世界中の独立したデータセンターから提供される計算リソースを、ICPというプロトコル（手順・ルール）でまとめることで、アプリケーションサービス等を実装できる分散型ネットワーク（＝インターネットコンピューター）を構築。

## 1-4. 他パブリックブロックチェーンとの相違
Dfinity財団は、プロジェクトを「ブロックチェーンにおける第三の発明」と位置づけ。  
ビットコインは「デジタルゴールド」、イーサリアムは「DeFi革命の原動力」とし、その上で自らを「あらゆるものを再構築できるブロックチェーン」と表現。  


![imageAlt](https://imgs.coinpost-ext.com/uploads/2021/10/WhatIs_Dfinity3.png "dfinity")   




---

# 2. ICPでの開発モチベ(C3Fの動画参照)
## 2-1. ユーザのガス負担が０（リバースガス機構）  
開発者側で負担する。チャージして使っていくモデル。
## 2-2. アプリ丸ごと分散化（フロントエンド） 
バックエンド含め、丸ごと載せることができるのはICならでは。
デメリットはAWSのような利便性はない。楽に開発したい人にとっては向いてない。  
一概にメリットとは言えないが、思想の問題。Amazonにデータ置きたくないなどあれば。 
## 2-3. HTTPアウトコール（WEB2データとの連携）
サブスクとかBTC払いでするのが簡単にできるし、web2の中に送金機能を組み込める。  
ガスがリバースガスなので、NFTを統合することで、イーサリアムのNFTをICにもってくると  
転送がガスフリーになるといったユースケースが考えられる。  
ここで、ガス代かからない利点活かせるのがすごい！
## 2-4. BTC統合
BTCAPIを介してUTXOのトランザクションを直接参照して、扱える。  
ckBTCキャニスターで、ビットコイン上のUTXOをIC上で再現している。  
ckとはchainkeyを意味し、wrapped btcに近いが異なる。ブリッジではない。  
カストディアルが管理してないので、*理論上ペグが外れることがない。*  
何かしら差別化しないといけないので、名付けたよう。LNライクなBTC。  
ICの仕組みで署名するので、BTCでより安価に送金が可能になる。  
BTCを扱ったDEXの登場が期待される。  

---

# 3. 現時点のデメリット
## 3-1. 負荷耐性/スケーリング
- 一番致命的な課題。ユーザーが増えた場合の懸念事項。Dfinityが解決してくれること期待。
- NNS1というガバナンストークン最近でたが、dfinityのダッシュボードにアクセス集中した際に落ちた。  
- web2では大したことないレベルだったにもかかわらず。原因は負荷耐性といわれている。  
- スケーリングについては、キャニスターは32GB、といった制限があるので、ストレージ扱うDappの場合、  
でスケーリングの処理を書かないといけない。(簡単にできるものなのか？調べる必要あり)
## 3-2. データ書き込みが遅い(updcall/1-2sec)
- querycallははやい
- データアップデートupdcallに関しては1,2秒で遅い。
- バックエンド側の更新遅いだけなので、フロントエンドで処理してしまって、裏側でその間処理すれば  
多少カバーできるか。アトミック性がないと言われている。
- データの書き込み1回2MB。なので、動画か画像をチャンク化して送る（ex パピルスというnoteのようなdapp）  
方法など活用する。ただし現在はその必要もなくなったらしい。
- 負荷分散しないと、今はすぐ落ちるのでまだ課題といえる状況。

## 3-3. 開発ツールの少なさ
- FirestoreのようなDBが欲しい。今は自身でデータ管理、アクセス制限といったセキュリティ周りもしないといけない。
- DBについては、3rdpartyで出てくる。(ex. weaveDB)なくても自前実装。
## 3-4. webviewからII認証できない
- スマホアプリにwebサイトを埋め込むとII認証できない仕様が確認されてる

## 3-5. コスト計算
- サービス運用時、不確実な要素が多くコスト見積もりが難しい。
- 時間が解決してくれるはず。

## 3-6. データの永続化
- コードをデプロイするときにその書き方しないといけない。
- 現時点では、データ型を変えるときにデータを引き継ぐような処理を書かないといけない。キャニスターごと変えてしまう仕様。
---

# 4. その他
- solidityと違い、ICだとガス代気にしないので書きやすい。MotokoかRustで書く。
- とりあえず動くアプリならmotokoで直感的に書ける。ただし、ライブラリが揃っていないためRustのが現時点応用効かせやすい。
- motoko hello worldアプリケーションから始めるといい。

---

# 5. 参考
- [【Web3開発者向け】Dfinity / ICでのWeb3開発メリット・デメリット~Dfinity / Internet ComputerでのWeb3開発ってどんな感じ？](https://www.youtube.com/watch?time_continue=3240&v=BoC0hVUh_K0&embeds_euri=https%3A%2F%2Fwww.c3f-iu-university.com%2F&embeds_origin=https%3A%2F%2Fwww.c3f-iu-university.com&source_ve_path=MjM4NTE&feature=emb_title)
- [初心者でもわかるDfinity（ICP）とは｜仕組みや特徴を解説](https://docs.google.com/spreadsheets/d/1ADpgs46n6afXYflnRmM-MCAqgTFf6TBCAzpQYKYAu_Y/edit#gid=34841844)
- [【Dfinity】Internet Computer と Bitcoinの 統合についての解説](https://hide.ac/articles/u41it9MrD)
- [[Dfinity] Dmailの仕組み](https://hide.ac/articles/epTQUrDlq)
- [A Beginner's Guide on How to Stake ICP Tokens on the Internet Computer's Network Nervous System (NNS)](https://www.google.com/url?q=https://www.dfinitycommunity.com/how-to-stake-icp-tokens-on-the-internet-computers-network-nervous-system-nns/&sa=D&source=editors&ust=1676202455037609&usg=AOvVaw2eetUM6OjhnQb-X1rqJKVj)

